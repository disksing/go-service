---
title: 服务器框架
---


# 框架简介
go-service是一款由Golang开发的分布式服务器开发框架。

## 架构功能及特点

  - 服务发现
    - 服务会自动发现，开发者无需关心服务分布在哪个进程或者哪台机器上，可以通过接口去获取和筛选服务。每个服务都可以设置多个额外的属性，供服务筛选函数使用。

  - 服务挂载
    - 服务可以根据配置挂载到不同的进程上，一个进程可以挂载一到多个服务，每个服务都在独立的协程上运行。这意味着在开发调试的时候可以把所有服务放在一个进程中，可以避免多个进程一起调试带来的繁琐。在部署的时候可以根据实际情况，自由组合，充分利用硬件资源。

  - 服务重用
    - 每个服务都是一个独立的微服务，这意味着一个项目的服务可以直接拿到其他项目复用，可以建立一个服务共享库，用于存放一些较为通用的服务，供项目直接使用或者二次开发。

  - 服务方法调用
    - 可以调用任意服务提供的RPC方法，支持同步调用和异步调用。

  - 分布式实体
    - Entity主要功能是提供了属性同步和方法调用。一个Entity可以存在于一个或者多个service中，一个service中的entity可以在属性发生改变时，自动同步给其他的service。通过EntityProxy可以调用任何service中entity的方法，支持同步调用和异步调用。

  - 序列化和反序列化
    - RPC消息的序列化和反序列化支持proto，自定义方法以及默认方法。



## 基础概念

框架中涉及三个基础概念：App、Service、Entity

 - App
   - App是指一个应用程序或者进程，可以通过配置文件加载各种Service。

 - Service
   - Service为游戏开发者开发的逻辑模块（比如组队，房间等），Service之间可以通信，每个Service均在独立协程中执行，即使某个Service出现问题也不会影响其他Service的执行。App会处理好Service的发现、管理以及通信，上层开发者不用关心Service是不是同一个进程或机器。每个Service都可以对外提供多个RPC函数，供其他Service调用，这些调用支持同步和异步两种方式。

 - Entity
   - Entity是Service中存在的基本对象，比如Player，Team等。Entity是分布式的，一个Entity可以分布在一到多个Service中，不同Service中ID相同Entity可以进行属性同步。Entity也会提供一些RPC方法供别人调用，同Service的方法一样，Entity的RPC方法也支持同步调用和异步调用两种方式。


App为一个进程，可以当做一个容器，根据配置加载一到多个Service，每个Service可以管理多个Entity。一个Service可以调用其他任何一个Service的RPC函数，也可以在任意Service中调用任何一个Entity的RPC函数。

下图中的App挂载了Service1和Service2两个服务，两个服务都创建了若干实体：

```
+--------Service1---------+    +--------Service2---------+
|  +------------------+   |    |  +------------------+   |
|  |      Entity1     |   |    |  |      Entity1     |   |
|  +------------------+   |    |  +------------------+   |
|  +------------------+   |    |  +------------------+   |
|  |      Entity2     |   |    |  |      Entity2     |   |
|  +------------------+   |    |  +------------------+   |
|           .             |    |           .             |
|           .             |    |           .             |
|           .             |    |           .             |
|  +------------------+   |    |  +------------------+   |
|  |      Entityn     |   |    |  |      Entityn     |   |
|  +------------------+   |    |  +------------------+   |
+-------------------------+    +-------------------------+
+--------------------------------------------------------+
|                           App                          |
+--------------------------------------------------------+

```
